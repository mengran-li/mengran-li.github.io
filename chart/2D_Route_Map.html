<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <title>2DRoutesMap - ECHARTS-GL</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes"> <!-- Fullscreen Landscape on iOS -->
  <!-- <link rel="stylesheet" href="./css/common.css"> -->
  <style>
    html {
      height: 100%;
    }

    body {
      background: url(../img/bg.jpg);
      background-size: 100% 100%;
      margin: 0;
    }

    #main {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }

    #toolbar {
      position: absolute;
      top: 10px;
      left: 10px;
      z-index: 1000;
    }
  </style>
</head>

<body>
  <div id="main"></div>
  <script src="https://cdn.bootcss.com/echarts/4.4.0-rc.1/echarts.min.js"></script>
  <script src="https://www.echartsjs.com/examples/vendors/echarts-gl/echarts-gl.js"></script>
  <script src="https://cdn.bootcss.com/jquery/2.2.3/jquery.min.js"></script>
  <script src="https://cdn.bootcss.com/echarts/4.4.0-rc.1/extension/bmap.js"></script>
  <!-- <script src="./data/data.js"></script> -->
  <!-- <script src="./set/settings_2D.js"></script> -->
  <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=L1gyDQb7Dx8YpXVcVly71IHK8GfpCV9d"></script>
  <script>
    var data = {"type":"FeatureCollection", "features": [
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.06408109960353,22.528971262633878],[114.06498428256852,22.52898882666664],[114.06496526819032,22.52919081288317],[114.0648797034883,22.529287414882326],[114.06475611003003,22.529357670839268],[114.06463251657156,22.529577220474547],[114.0646135021935,22.529603566407285],[114.0647846315973,22.529963626985275],[114.0648606891101,22.529928499165273]]},"properties":{"value":1}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.0648606891101,22.529928499165273],[114.0647846315973,22.52996362698534],[114.06498150963841,22.53036759627274],[114.0648626697745,22.530411505906724],[114.06492208970653,22.530751805097033],[114.06502904558387,22.530735339026464]]},"properties":{"value":1}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.06502904558387,22.530735339026464],[114.06492208970653,22.530751805097033],[114.0648626697745,22.530411505906724],[114.06498150963841,22.53036759627274],[114.06541527514128,22.530241355997287],[114.06529643527749,22.53001082997926]]},"properties":{"value":1}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.06529643527749,22.53001082997926],[114.06541527514128,22.530241355997287],[114.06554005699829,22.530197446309256],[114.06560541892341,22.53021391244382],[114.06581933067827,22.530373084977732],[114.06633034209254,22.53032917533152],[114.06644918195644,22.53071338426267],[114.06651454388145,22.530696918187456]]},"properties":{"value":1}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.06651454388145,22.530696918187456],[114.06644918195644,22.53071338426267],[114.0665501958407,22.531059171387056],[114.06697801935033,22.530943909108345],[114.06737019090096,22.530823158046687],[114.06771482650599,22.530707895571123],[114.06785149234938,22.530696918187456],[114.06862395146403,22.530691429495374],[114.06856453153215,22.531152478875473],[114.06867148740962,22.53147082159717],[114.06883192122577,22.531459844274178]]},"properties":{"value":1}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.06883192122577,22.531459844274178],[114.06867148740962,22.53147082159717],[114.06856453153215,22.531152478875473],[114.06789902829483,22.531207365604004],[114.06795250623361,22.531399468981963],[114.0675187407306,22.53149277624059]]},"properties":{"value":1}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.0675187407306,22.53149277624059],[114.06795250623361,22.531399468981963],[114.06838627173649,22.53304605840645],[114.06817235998165,22.53310094438262],[114.06822583792034,22.533342442418554],[114.06828525785224,22.533314999481195]]},"properties":{"value":1}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.06828525785224,22.533314999481195],[114.06822583792034,22.533342442418554],[114.06826743187264,22.533556497142904],[114.06786931832889,22.53360040576325],[114.06782178238336,22.533166807525216],[114.06763758059445,22.533221693453303],[114.06767917454675,22.53343025978144],[114.0677385944787,22.533419282614165]]},"properties":{"value":1}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.0655757089574,22.533995582718838],[114.06626498016749,22.534039491199618],[114.06619961824249,22.53374310868324]]},"properties":{"value":2}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.06619961824255,22.53374310868324],[114.06606889439229,22.533068012799582]]},"properties":{"value":2}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.06606889439229,22.533068012799582],[114.06614216438619,22.533446400708456],[114.06646700793591,22.533391839691998],[114.06639570401767,22.533013126810367]]},"properties":{"value":2}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.06639570401767,22.533013126810367],[114.06646700793591,22.533391839691998],[114.0667997595546,22.53333146524428],[114.06687106347296,22.533721154397455]]},"properties":{"value":2}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.06687106347296,22.533721154397455],[114.0667997595546,22.53333146524428],[114.06728106100306,22.533271090770054],[114.06738207488739,22.533836414358866],[114.06744743681237,22.533819948655893]]},"properties":{"value":2}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.06744743681237,22.533819948655893],[114.06738207488739,22.533836414358866],[114.06742961083286,22.534121819563588],[114.06761975461485,22.534127308119427],[114.0677980144106,22.534110842451263],[114.06773265248559,22.53379250581347],[114.06766729056046,22.533808971519584]]},"properties":{"value":2}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.06766729056046,22.533808971519584],[114.06773265248559,22.53379250581347],[114.06763758059445,22.533221693453303],[114.06747120478522,22.533254624999767],[114.0674177268465,22.53299117240852],[114.06717410512572,22.532606969812345],[114.06728700299625,22.532568549493917],[114.06742366883961,22.532524640545518],[114.06750685674433,22.53251915192593],[114.06757221866947,22.53244231122962]]},"properties":{"value":2}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.06757221866947,22.53244231122962],[114.06750685674433,22.53251915192593],[114.06742366883961,22.532524640545518],[114.06728700299625,22.532568549493917],[114.06717410512572,22.532606969812345],[114.06687700546608,22.53215141392064],[114.06680570154784,22.532047129830605],[114.06679381756142,22.53183856141418],[114.06678787556831,22.531668413262253],[114.06660367377934,22.531174433569554],[114.06589657658968,22.531399468981963],[114.06595005452839,22.53153668551692],[114.0658728086169,22.531558640149864]]},"properties":{"value":2}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.07078089499221,22.53062556517254],[114.06989553800682,22.530614587782434],[114.06990148000006,22.53031819791788],[114.06955684439495,22.53032917533152],[114.0695627863882,22.530389551091467]]},"properties":{"value":3}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.0695627863882,22.530389551091467],[114.06955684439502,22.53032917533152],[114.06932510666051,22.530323686624833],[114.06911713689892,22.52936315958432],[114.0686655454164,22.52934120460248],[114.06858829950491,22.530307220503172],[114.06828525785224,22.530312709210584],[114.06826148987953,22.530038273572995],[114.06825554788635,22.529873611928732],[114.0684219236956,22.529873611928732]]},"properties":{"value":3}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.0684219236956,22.529873611928732],[114.06825554788635,22.529873611928732],[114.06826148987953,22.530038273572995],[114.06828525785224,22.530312709210584],[114.06663932573846,22.530312709210584],[114.06633034209254,22.53032917533152],[114.06639783416628,22.53054737713864],[114.06619961824242,22.53059812169552]]},"properties":{"value":3}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.06619961824242,22.53059812169552],[114.06639783416628,22.53054737713864],[114.06633034209254,22.53032917533152],[114.06581933067827,22.530373084977732],[114.06560541892341,22.53021391244382],[114.06554005699829,22.530197446309256],[114.0648626697745,22.530411505906724],[114.06502904558387,22.53108661477249],[114.06488049575417,22.531114058152593]]},"properties":{"value":3}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.06488049575417,22.531114058152593],[114.06502904558387,22.53108661477249],[114.06513005946812,22.531558640149864],[114.06522513135913,22.532343515985897],[114.06474382991073,22.532398402241157],[114.06473788791762,22.532288629708827]]},"properties":{"value":3}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.06473788791762,22.532288629708827],[114.06474382991073,22.532398402241157],[114.06429223842834,22.53240937948956],[114.0642031085305,22.53254659502146],[114.06322862164721,22.53251915192593],[114.06323456364046,22.532606969812345],[114.06354948927948,22.53263990150529],[114.06369803910934,22.53267832180386],[114.06368021312974,22.533347931005345],[114.0638347049527,22.533353419591997]]},"properties":{"value":3}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.07007973979586,22.533444530097714],[114.06984443686545,22.533325976656766],[114.06973748098795,22.533227182044968],[114.06968756824521,22.533069110519047],[114.06978739373085,22.533062524201593]]},"properties":{"value":4}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.06978739373085,22.533062524201593],[114.06968756824527,22.53306911051911],[114.06963052511054,22.532785898582915],[114.06956635158416,22.532370959116186],[114.0694166133557,22.532384131816933]]},"properties":{"value":4}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.0694166133557,22.532384131816933],[114.06956635158416,22.532370959116186],[114.06954496040866,22.532094332112656],[114.06970182902884,22.53210750483965]]},"properties":{"value":4}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.06970182902884,22.53210750483965],[114.06954496040866,22.532094332112656],[114.0695021780577,22.531514730880534],[114.06965191628603,22.53152131727178]]},"properties":{"value":4}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.06965191628603,22.53152131727178],[114.0695021780577,22.531514730880534],[114.0694950476658,22.53127103418173],[114.06993713195918,22.531277620584603],[114.0699157407837,22.530961472890468],[114.0701866956732,22.530968059308098]]},"properties":{"value":4}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.0701866956732,22.530968059308098],[114.0699157407837,22.530961472890468],[114.06989553800682,22.530614587782498],[114.06938096139658,22.530618978738637],[114.06862395146403,22.530691429495374],[114.06856453153215,22.531152478875473],[114.06867148740962,22.53147082159717],[114.06882479083392,22.532008709356482],[114.06860374868735,22.532048227558267]]},"properties":{"value":4}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.06860374868735,22.532048227558267],[114.06882479083392,22.532008709356482],[114.06891035553585,22.532338027359117],[114.06901731141335,22.53268710358492],[114.06927400551916,22.532667344576833]]},"properties":{"value":4}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.06927400551922,22.532667344576833],[114.06901731141335,22.53268710358492],[114.06908861533158,22.532904452487386],[114.06914565846618,22.53300324732999],[114.06921696238449,22.533312804045963],[114.06907435454795,22.533319390351483]]},"properties":{"value":4}},
{"type":"Feature","geometry":{"type":"LineString","coordinates":[[114.06907435454795,22.533319390351483],[114.06921696238449,22.533312804045963],[114.06933817904562,22.533767258393517],[114.06945226531482,22.5337409132548]]},"properties":{"value":4}}
]}





// 此脚本用于修改图表的参数

// 路线属性
var colorOrWidth  = 3 ; // 0代表既不用色彩也不用宽度来表示值，1代表用色彩，2代表用宽度，3代表二者皆用
var theColorRamp  = ['#313695', '#4575b4', '#74add1', '#abd9e9', '#e0f3f8', '#ffffbf', '#fee090', '#fdae61', '#f46d43', '#d73027']; // 路线颜色
var theWidthRatio = 0.2 // 宽度与值的比值

// 固定属性，当该属性没有和值相关，会自动设成如下值
var theColor  = 'rgb(200, 35, 45)'; // 线的颜色
var theWidth  = 2;    // 线的宽度
var theOpac   = 0.3;  // 线的透明度

// 地图相关
var theCenter = [114.065902,22.531591]; // 中心点坐标
var theZoom   = 18; //视角远近 数字

// 动画效果
var effectShow  = true;// 是否展示动画
var theSpeed    = 40;   // 尾迹速度，当尾迹速度不等于 0 时，使用单次循环时间作为速度依据
var thePeriod   = 6;   // 单次循环时间，只有当尾迹速度为 0 时才能生效
var theEffWidth = 8;   // 尾迹宽度
var theEffLength= 0.6; // 尾迹长度

// 百度地图
// 百度地图的accesstoken需要到 html 的第18行 自行进行替换
var mapStyle= [
          {
                    "featureType": "water",
                    "elementType": "all",
                    "stylers": {
                              "color": "#021019"
                    }
          },
          {
                    "featureType": "highway",
                    "elementType": "geometry.fill",
                    "stylers": {
                              "color": "#000000"
                    }
          },
          {
                    "featureType": "highway",
                    "elementType": "geometry.stroke",
                    "stylers": {
                              "color": "#147a92"
                    }
          },
          {
                    "featureType": "arterial",
                    "elementType": "geometry.fill",
                    "stylers": {
                              "color": "#000000"
                    }
          },
          {
                    "featureType": "arterial",
                    "elementType": "geometry.stroke",
                    "stylers": {
                              "color": "#0b3d51"
                    }
          },
          {
                    "featureType": "local",
                    "elementType": "geometry",
                    "stylers": {
                              "color": "#000000"
                    }
          },
          {
                    "featureType": "land",
                    "elementType": "all",
                    "stylers": {
                              "color": "#08304b"
                    }
          },
          {
                    "featureType": "railway",
                    "elementType": "geometry.fill",
                    "stylers": {
                              "color": "#000000"
                    }
          },
          {
                    "featureType": "railway",
                    "elementType": "geometry.stroke",
                    "stylers": {
                              "color": "#08304b"
                    }
          },
          {
                    "featureType": "subway",
                    "elementType": "geometry",
                    "stylers": {
                              "lightness": -70
                    }
          },
          {
                    "featureType": "building",
                    "elementType": "geometry.fill",
                    "stylers": {
                              "color": "#000000"
                    }
          },
          {
                    "featureType": "all",
                    "elementType": "labels.text.fill",
                    "stylers": {
                              "color": "#857f7f"
                    }
          },
          {
                    "featureType": "all",
                    "elementType": "labels.text.stroke",
                    "stylers": {
                              "color": "#000000"
                    }
          },
          {
                    "featureType": "building",
                    "elementType": "geometry",
                    "stylers": {
                              "color": "#022338"
                    }
          },
          {
                    "featureType": "green",
                    "elementType": "geometry",
                    "stylers": {
                              "color": "#062032"
                    }
          },
          {
                    "featureType": "boundary",
                    "elementType": "all",
                    "stylers": {
                              "color": "#1e1c1c"
                    }
          },
          {
                    "featureType": "manmade",
                    "elementType": "geometry",
                    "stylers": {
                              "color": "#022338"
                    }
          },
          {
                    "featureType": "poi",
                    "elementType": "all",
                    "stylers": {
                              "visibility": "off"
                    }
          },
          {
                    "featureType": "all",
                    "elementType": "labels.icon",
                    "stylers": {
                              "visibility": "off"
                    }
          },
          {
                    "featureType": "all",
                    "elementType": "all",
                    "stylers": {
                              "lightness": 10,
                              "saturation": -100
                    }
          }
]
var myChart = echarts.init(document.getElementById('main'));

console.log(data);

if (colorOrWidth == 0) {
  var lines2 = data.features.map(function (theD) {
    return {
      coords: theD.geometry.coordinates
    }
  })
};

if (colorOrWidth == 1) {
  var lines2 = data.features.map(function (theD) {
    return {
      coords: theD.geometry.coordinates,
      lineStyle: {
        normal: {
          color: theColorRamp[theD.properties.value - 1],
        }
      }
    }
  })
}

if (colorOrWidth == 2) {
  var lines2 = data.features.map(function (theD) {
    return {
      coords: theD.geometry.coordinates,
      lineStyle: {
        normal: {
          width: theD.properties.value * theWidthRatio,
        }
      }
    }
  })
}

if (colorOrWidth == 3) {
  var lines2 = data.features.map(function (theD) {
    return {
      coords: theD.geometry.coordinates,
      lineStyle: {
        normal: {
          color: theColorRamp[theD.properties.value - 1],
          width: theD.properties.value * theWidthRatio
        }
      }
    }
  })
}


myChart.setOption(option = {
  bmap: {
    center: theCenter,
    zoom: theZoom,
    roam: true,
    mapStyle: {
      'styleJson': mapStyle
    }
  },
  series: [{
    type: 'lines',
    coordinateSystem: 'bmap',
    polyline: true,
    data: lines2,
    silent: true,
    lineStyle: {
      normal: {
        // color: '#c23531',
        color: theColor,
        opacity: theOpac,
        width: theWidth
      }
    },
    progressiveThreshold: 500,
    progressive: 200
  }, {
    type: 'lines',
    coordinateSystem: 'bmap',
    polyline: true,
    data: lines2,
    lineStyle: {
      normal: {
        width: 0
      }
    },
    effect: {
      period: thePeriod,
      constantSpeed: theSpeed,
      show: effectShow,
      trailLength: theEffLength,
      symbolSize: theEffWidth
    },
    zlevel: 1
  }]
});
   
         
  </script>
</body>

</html>